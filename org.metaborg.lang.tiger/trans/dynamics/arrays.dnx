module arrays

imports dnx-lib

rules
  eval-exp(Array(_, size, init_val)) =
    s <- eval-exp(size);
    arr <- create-default-array[eval-exp](s, init_val);
    return(arr)
  
  eval-exp(Subscript(a, i)) =
    array <- eval-exp(a);
    index <- eval-exp(i);
    return(array-get-index(array, index))
    
  eval-exp(Assign(Subscript(array, index), value)) = 
    idx <- eval-exp(index);
    arr <- eval-exp(array);
    val <- eval-exp(value);
    array-set-index(arr, idx, val);
    return(null())